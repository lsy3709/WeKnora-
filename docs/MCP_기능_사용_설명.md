## MCP 기능 사용 설명

### 기능 개요
- MCP (Model Context Protocol)를 통해 WeKnora는 외부 도구 또는 데이터 소스에 안전하게 연결할 수 있으며, 에이전트(Agent)가 추론 시 호출할 수 있는 능력을 확장합니다.
- 프론트엔드의 `설정 > MCP 서비스`(`frontend/src/views/settings/McpSettings.vue`)에서 모든 서비스를 통합 관리할 수 있으며, 설정 파일을 수동으로 수정할 필요가 없습니다.
- 각 서비스는 이름, 전송 방식 (SSE / HTTP Streamable / Stdio), 접속 주소 또는 명령어, 인증 정보, 그리고 고급 타임아웃 및 재시도 전략을 포함합니다.

### 진입 및 인터페이스
- 콘솔 왼쪽 메뉴의 `설정 -> MCP 서비스`를 열면 현재 테넌트 아래의 모든 MCP 서비스 목록을 확인할 수 있습니다.
- 목록에서 서비스를 빠르게 켜고 끌 수 있으며, 설명을 확인하고 오른쪽 메뉴를 통해 "테스트 / 편집 / 삭제"를 실행할 수 있습니다.
- "서비스 추가" 버튼을 누르면 서비스 생성 또는 수정을 위한 `McpServiceDialog`가 나타납니다.

### 주요 작업 프로세스
1. **서비스 생성**
   - "서비스 추가"를 클릭하고 이름과 설명을 입력한 후 전송 방식을 선택합니다.
   - SSE / HTTP Streamable 방식은 접속 가능한 서비스 URL이 필요합니다. Stdio 방식은 `uvx` 또는 `npx` 명령어와 파라미터가 필요하며, 환경 변수를 추가할 수 있습니다.
   - 필요에 따라 API Key, Bearer Token, 타임아웃 및 재시도 전략을 입력하고 저장하면 목록에 서비스가 나타납니다.
2. **서비스 활성화/비활성화**
   - 목록의 스위치를 통해 활성화 상태를 전환하면 시스템이 즉시 백엔드의 `updateMCPService`를 호출합니다. 실패 시 상태가 자동으로 복구되며 알림이 표시됩니다.
3. **연결 테스트**
   - 더보기 메뉴에서 "테스트"를 선택하면 프론트엔드가 `/api/v1/mcp-services/{id}/test`를 호출하고 `McpTestResult` 창을 띄웁니다.
   - 성공 시 서비스에서 사용 가능한 도구 목록(입력 스키마 포함)과 리소스 목록이 표시됩니다. 실패 시 오류 메시지가 표시되어 네트워크나 인증 문제를 파악하기 쉽습니다.
4. **편집 / 삭제**
   - "편집"을 선택하면 기존 설정을 불러와 수정 후 저장할 수 있습니다.
   - "삭제"는 팝업창에서 확인 후 실행하며, 완료되면 목록이 자동으로 새로고침됩니다.

### 사용 권장 사항
- **전송 방식 선택**: 스트리밍 경험을 위해 SSE를 우선적으로 사용하십시오. 표준 HTTP Streamable 호환성이 필요한 경우에만 해당 방식을 선택하십시오. 로컬 디버깅이나 오프라인 환경에서는 Stdio 방식을 사용하여 동일한 머신에서 MCP 서버를 구동하는 것이 적합합니다.
- **인증 관리**: API Key 또는 Token을 "인증 설정"에 저장하십시오. 운영 환경에서는 최소 권한을 가진 키를 별도로 생성하고 정기적으로 갱신하는 것이 좋습니다.
- **재시도 전략**: 공용 네트워크나 제3자 서비스의 경우 `retry_count`와 `retry_delay`를 적절히 높여 일시적인 타임아웃으로 인한 에이전트 중단을 방지하십시오.
